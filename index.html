<html>
<head>
<title>Artist Clusters</title>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>


<link rel = "stylesheet" type = "text/css" href = "styles/style.css" />
</head>
<body>


<div id="container">

	<h1>One-Hit Wonders</h1>

	<svg height="600" width="960" />

	<br><br><br>

	<select name="decades" id="decades" value="Sixties"
	oninput="showCircles(this.value)"
	onchange="showCircles(this.value)">
    	<option value="Sixties">1960s</option>
    	<option value="Seventies">1970s</option>
    	<option value="Eighties">1980s</option>
    	<option value="Nineties">1990s</option>
    	<option value="Two_Thousands">2000s</option>
    	<option value="Twenty_Tens">2010s</option>
  	</select>

</div>


<script>

	var artistValues;

	var radiusSize = 5;

	var decade = document.getElementById("decades").value;

	function mutateRow(row) {

		row["Artist"] = row["Artist"];

		row["Sixties"] = Number(row["Sixties"]);
		row["Seventies"] = Number(row["Seventies"]);
		row["Eighties"] = Number(row["Eighties"]);
		row["Nineties"] = Number(row["Nineties"]);
		row["Two_Thousands"] = Number(row["Two_Thousands"]);
		row["Twenty_Tens"] = Number(row["Twenty_Tens"]);

		row["Gender"] = row["Gender"];

		console.log(row);

		return row;

	}

	function callback(error, data){

		artistValues = data.map(function(d){
			return {
				Artist: d.Artist,
				Sixties: d.Sixties,
				Seventies: d.Seventies,
				Eighties: d.Eighties,
				Nineties: d.Nineties,
				Two_Thousands: d.Two_Thousands,
				Twenty_Tens: d.Twenty_Tens,
				Gender: d.Gender
			};
		});


		showCircles(decade);
	}


	function showCircles(decade){

		d3.selectAll("circle").remove();
		d3.selectAll("text").remove();

		var svg = d3.select("svg");

		svg.append("text")
		.attr("x", 10)
		.attr("y", 30)
		.style("font-size", 26)
		.style("fill", "#BBBBBB")
		.text(function(d){
			if(decade=="Sixties") {
				return "1960s";
			} else if (decade=="Seventies"){
				return "1970s";
			} else if (decade=="Eighties"){
				return "1980s";
			} else if (decade=="Nineties"){
				return "1990s";
			} else if (decade=="Two_Thousands"){
				return "2000s";
			} else if (decade=="Twenty_Tens"){
				return "2010s";
			} else {
				return "";
			}
		})

		svg.selectAll("dot")
		.data(artistValues)
		.enter().append("circle")
			.attr("id", function(d) { return d.Artist; })
			.attr("class", "artistCircle")
			.attr("r", function(d) {

				if(decade=="Sixties" && d.Sixties > 0) {
					return d.Sixties * radiusSize + 3;
				} else if (decade=="Seventies" && d.Seventies > 0){
					return d.Seventies * radiusSize + 3;
				} else if (decade=="Eighties" && d.Eighties > 0){
					return d.Eighties * radiusSize + 3;
				} else if (decade=="Nineties" && d.Nineties > 0){
					return d.Nineties * radiusSize + 3;
				} else if (decade=="Two_Thousands" && d.Two_Thousands > 0){
					return d.Two_Thousands * radiusSize + 3;
				} else if (decade=="Twenty_Tens" && d.Twenty_Tens > 0){
					return d.Twenty_Tens * radiusSize + 3;
				} else {
					return 0;
				}

			 })
			.style("fill", function(d){

				if(d.Gender == "male"){
					return "#399FF9";
				} else if (d.Gender == "female"){
					return "#F955F2";
				} else {
					return "#AFAFAF";
				}

			})
			.style("opacity", "0.5");

		d3.selectAll("circle").each(function(d, i) {

			d3.select(this)
			.attr("cx", Math.random() * 960)
			.attr("cy", Math.random() * 600);

		});

	}

	d3.csv("artist_song_counts1.csv", mutateRow, callback);

</script>


</body>
</html>